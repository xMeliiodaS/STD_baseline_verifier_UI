<Window x:Class="AT_baseline_verifier.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="AT Baseline Verifier"
        Height="500" Width="600"
        Background="#1E1E1E"
        WindowStartupLocation="CenterScreen"
        Style="{StaticResource MaterialDesignWindow}"
        AllowDrop="True"
        Drop="Window_Drop"
        DragOver="Window_DragOver">


    <Grid Margin="20, 20, 20, 5">


        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Text="Test Baseline Verifier"  
                   Foreground="White"  
                   HorizontalAlignment="Center"  
                   FontSize="26"  
                   FontWeight="Bold"  
                   Margin="0,0,0,20"/>

        <!-- Main Content -->
        <Border Grid.Row="1" Background="#2D2D30" CornerRadius="12" Padding="20" Margin="0,0,0,59" Grid.RowSpan="2">
            <StackPanel>

                <!-- File Selector -->
                <Button x:Name="SelectSTDButton" Click="SelectFile_Click"  
                        Style="{StaticResource PurpleButton}"  
                        Margin="0,0,0,4"  
                        Cursor="Hand">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Text="📂"  
                                   FontSize="18"  
                                   Margin="0,0,8,0"  
                                   VerticalAlignment="Center" />

                        <TextBlock Grid.Column="1"  
                                   Text="Select STD (Excel)"  
                                   TextWrapping="Wrap"  
                                   VerticalAlignment="Center" />
                    </Grid>
                </Button>

                <!-- Drag & Drop Hint -->
                <TextBlock Text="Or drag and drop an Excel file here"  
                           Foreground="LightGray"  
                           FontStyle="Italic"  
                           FontSize="12"  
                           HorizontalAlignment="Center"  
                           Margin="0,0,0,10" />

                <!-- Selected File Label -->
                <TextBlock x:Name="SelectedFileLabel"  
                           HorizontalAlignment="Center"  
                           Text="No file selected"  
                           Foreground="LightGray"  
                           FontSize="14"  
                           TextWrapping="Wrap"  
                           Margin="0,10,0,0" />

                <!-- STD Name with Placeholder -->
                <!-- STD Name with Placeholder -->
                <Grid Margin="0,3,0,12" MaxWidth="300">
                    <TextBox x:Name="STDNameInput"  
                             Background="#3C3C3C"  
                             Foreground="White"  
                             BorderBrush="#555"  
                             Padding="8"  
                             FontSize="14"  
                             HorizontalContentAlignment="Center"
                             TextChanged="STDNameInput_TextChanged"/>
                    <TextBlock x:Name="STDPlaceholder"  
                       Text="STD Name"  
                       HorizontalAlignment="Center"  
                       Foreground="Gray"  
                       Margin="12,0,0,0"  
                       VerticalAlignment="Center"  
                       IsHitTestVisible="False"/>
                </Grid>

                <!-- Iteration Path + Current V&V Version side by side -->
                <Grid Margin="0,3,0,28" MaxWidth="430">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <!-- Iteration Path -->
                    <Grid Grid.Column="0" Margin="0,0,5,0" MaxWidth="200">
                        <TextBox x:Name="IterationPathInput"  
                             Background="#3C3C3C"  
                             Foreground="White"  
                             BorderBrush="#555"  
                             Padding="8"  
                             FontSize="14"  
                             HorizontalContentAlignment="Center"
                             TextChanged="IterationPathInput_TextChanged"/>
                        <TextBlock x:Name="IterationPathPlaceholder"  
                           Text="Iteration Path"  
                           HorizontalAlignment="Center"  
                           Foreground="Gray"  
                           Margin="12,0,0,0"  
                           VerticalAlignment="Center"  
                           IsHitTestVisible="False"/>
                    </Grid>

                    <!-- Current V&V Version -->
                    <Grid Grid.Column="1" Margin="0,0,0,0" MaxWidth="200">
                        <TextBox x:Name="VVVersionInput"  
                             Background="#3C3C3C"  
                             Foreground="White"  
                             BorderBrush="#555"  
                             Padding="8"  
                             FontSize="14"  
                             HorizontalContentAlignment="Center"
                             TextChanged="VVVersionInput_TextChanged"/>
                        <TextBlock x:Name="VVVersionPlaceholder"  
                           Text="Current VV Version"  
                           HorizontalAlignment="Center"  
                           Foreground="Gray"  
                           Margin="12,0,0,0"  
                           VerticalAlignment="Center"  
                           IsHitTestVisible="False"/>
                    </Grid>
                </Grid>
                <!-- ACTION BUTTONS -->
                <Grid Margin="0,0,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Run Full Verification -->
                    <Button x:Name="RunAutomationButton"
            Grid.Row="0"
            Click="RunAutomation_Click"
            Style="{StaticResource GreenButton}"
            Cursor="Hand"
            Margin="0,0,0,6">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Play Icon -->
                            <TextBlock x:Name="RunIcon" Text="▶" FontSize="18" Margin="0,0,8,0" VerticalAlignment="Center" />

                            <!-- Button Text -->
                            <TextBlock x:Name="RunButtonText" Grid.Column="1" Text="Check STD Bugs in VSTS" TextWrapping="Wrap" VerticalAlignment="Center" />

                            <!-- Spinner inside button -->
                            <Ellipse x:Name="ButtonSpinner" Width="16" Height="16" Stroke="White" StrokeThickness="2"
                     StrokeDashArray="2,2" Visibility="Collapsed"
                     HorizontalAlignment="Left" VerticalAlignment="Center" Margin="0,0,8,0">
                                <Ellipse.RenderTransform>
                                    <RotateTransform x:Name="ButtonSpinnerRotate" CenterX="8" CenterY="8"/>
                                </Ellipse.RenderTransform>
                                <Ellipse.Triggers>
                                    <EventTrigger RoutedEvent="FrameworkElement.Loaded">
                                        <BeginStoryboard x:Name="ButtonSpinnerStoryboard">
                                            <Storyboard RepeatBehavior="Forever">
                                                <DoubleAnimation Storyboard.TargetName="ButtonSpinnerRotate"
                                                 Storyboard.TargetProperty="Angle"
                                                 From="0" To="360" Duration="0:0:1"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                </Ellipse.Triggers>
                            </Ellipse>
                        </Grid>
                    </Button>

                    <!-- Check Excel Violations -->
                    <Button x:Name="RunViolationButton" 
        Grid.Row="1" 
        Click="RunViolationCheck_Click" 
        Style="{StaticResource BlueButton}" 
        Cursor="Hand"
        Margin="0,10,0,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Play Icon -->
                            <TextBlock x:Name="ViolationIcon" Text="" FontSize="15" VerticalAlignment="Center" />

                            <!-- Button Text -->
                            <TextBlock x:Name="RunViolationButtonText" Grid.Column="1" Text="Validate STD Rules" TextWrapping="Wrap" VerticalAlignment="Center" />

                            <!-- Spinner inside button -->
                            <Ellipse x:Name="ViolationButtonSpinner" Width="16" Height="16" Stroke="White" StrokeThickness="2"  
         StrokeDashArray="2,2" Visibility="Collapsed"  
         HorizontalAlignment="Left" VerticalAlignment="Center" Margin="0,0,8,0">
                                <Ellipse.RenderTransform>
                                    <RotateTransform x:Name="ViolationButtonSpinnerRotate" CenterX="8" CenterY="8"/>
                                </Ellipse.RenderTransform>
                                <Ellipse.Triggers>
                                    <EventTrigger RoutedEvent="FrameworkElement.Loaded">
                                        <BeginStoryboard x:Name="ViolationSpinnerStoryboard">
                                            <Storyboard RepeatBehavior="Forever">
                                                <DoubleAnimation Storyboard.TargetName="ViolationButtonSpinnerRotate"
                                     Storyboard.TargetProperty="Angle"
                                     From="0" To="360" Duration="0:0:1"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                </Ellipse.Triggers>
                            </Ellipse>
                        </Grid>
                    </Button>
                </Grid>


            </StackPanel>
        </Border>

        <!-- Status Bar -->
        <Border Grid.Row="2" Background="#2D2D30" Padding="8" CornerRadius="8" Margin="0,1,0,0">
            <StackPanel HorizontalAlignment="Center">
                <TextBlock x:Name="StatusText"   
                           Text="Ready"   
                           Foreground="LightGray"   
                           FontSize="12"   
                           HorizontalAlignment="Center" />
                <TextBlock Text="Developed by Bahaa"   
                           Foreground="Gray"   
                           FontSize="11"   
                           FontStyle="Italic"   
                           Margin="0,4,0,0"   
                           HorizontalAlignment="Center" />
            </StackPanel>
        </Border>

    </Grid>
</Window> 